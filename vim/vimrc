" Init Plug
if empty(glob('~/.local/share/nvim/site/autoload/plug.vim'))
   !curl -fLo ~/.local/share/nvim/site/autoload/plug.vim --create-dirs https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim
  autocmd VimEnter * PlugInstall --sync | source $MYVIMRC
endif

source ~/.vim/plugins.vim

set backspace=2
set autoindent
set autoread
set backupskip=/tmp/*,/private/tmp/*
set clipboard=unnamed
set encoding=utf-8
set expandtab
set incsearch
set laststatus=2
set linebreak
set list
set listchars=tab:>-,trail:.,extends:>,precedes:<
set mouse=a
set mousefocus
set nobackup
set noswapfile
set number
set ruler
set numberwidth=5
set relativenumber
set scrolloff=5
set shiftwidth=2
set smartcase
set softtabstop=2
set splitbelow splitright
set tabstop=2
set winwidth=79 winheight=5 winminheight=5 winheight=999
set textwidth=80
set colorcolumn=+1
set termguicolors
set wildmode=longest:full,full
if exists("+spelllang")
  set spelllang=en_us
endif

" automatically create undodir if it doesn't exist
set undodir=~/.cache/vim/undo//
if !isdirectory(expand(&undodir))
  call mkdir(expand(&undodir), "p")
endif

command! -bang W w
command! -bang Q q
command! -bang Qa qa
command! -bang Wq wq
command! -bang Wqa wqa

" REST OF FILE CONTAINS MAPPINGS
let mapleader = " "

" Vertical split to alternative file
map <C-w>t <C-w>v<C-w>l:A<CR>
nmap <Leader>- :sp<CR>
nmap <Leader>= :vsp<CR>

nmap Q <Nop>
nmap K <Nop>

" Navigate splits
map <C-h> <C-w>h
map <C-l> <C-w>l
map <C-k> <C-w>k
map <C-j> <C-w>j

" ZenCoding
let g:user_emmet_expandabbr_key = '<c-space>'

" open files in directory of current file
cnoremap %% <c-r>=expand('%:h').'/'<cr>
map <leader>e :edit %%

" Ayu theme
" let ayucolor="light"
let ayucolor="mirage"
" let ayucolor="dark"
colorscheme ayu
" IndentLine
let g:indentLine_char = '▏'
let g:indentLine_first_char = '▏'
let g:indentLine_showFirstIndentLevel = 1
let g:indentLine_setColors = 0

" Recursice remove
let g:netrw_localrmdir = "rm -rf"
let g:netrw_bufsettings = "noma namod nu rnu nobl nowrap ro"

nnoremap <F5> :GundoToggle<CR>
let g:gundo_width = 60
let g:gundo_preview_height = 60
let g:gundo_right = 1

" Ag command line option
let g:ag_prg="ag --vimgrep --smart-case"

let g:deoplete#enable_at_startup = 1
let g:neosnippet#enable_completed_snippet = 1

" Prettier
let g:prettier#exec_cmd_async = 1
let g:prettier#autoformat = 0
let g:prettier#autoformat = 0
autocmd BufWritePre *.js,*.jsx,*.mjs,*.ts,*.tsx,*.css,*.less,*.scss,*.json,*.graphql,*.md,*.vue PrettierAsync

" Languages
set hidden

    " 'javascript': ['flow-language-server', '--stdio'],
let g:LanguageClient_serverCommands = {
    \ 'javascript': ['flow', '--lazy-mode', 'lsp'],
    \ 'javascript.jsx': ['flow', '--lazy-mode', 'lsp'],
    \ 'typescript': ['javascript-typescript-stdio'],
    \ 'elixir': ['~/.elixir-ls/language_server.sh']
    \ }
let g:LanguageClient_rootMarkers = {
      \ 'javascript': ['package.json'],
      \ 'javascript.jsx': ['package.json'],
      \}
nnoremap <F4> :call LanguageClient_contextMenu()<CR>
" Or map each action separately
nnoremap <silent> K :call LanguageClient#textDocument_hover()<CR>
nnoremap <silent> gd :call LanguageClient#textDocument_definition()<CR>
nnoremap <silent> <F2> :call LanguageClient#textDocument_rename()<CR>


nnoremap <silent> <Leader>P :Commands<CR>
nnoremap <silent> <Leader>p :Files<CR>

" Minisnip
let g:minisnip_trigger = '<c-e>'

" Allow per project .nvimrc file to load
set exrc
set secure

